<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>R access to the API for the CATMAID web image annotation
    tool • catmaid</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="R access to the API for the CATMAID web image annotation
    tool">
<meta property="og:description" content="This package provide access to the API exposed
    by the CATMAID (C ollaborative A nnotation T oolkit for M assive A
    mounts of I mage D ata) web tool. This includes a bridge to the
    neuroanatomy toolbox (R package nat), thereby allowing analysis and
    visualisation of neuronal skeletons.">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">catmaid</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.10.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/example-drosophila-larva-olfactory-system.html">Introductory Example - Drosophila Larval Olfaction</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
<li>
  <a href="SUPPORT.html">Help</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://natverse.github.io">natverse</a>
</li>
<li>
  <a href="https://github.com/jefferis/rcatmaid">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">


<div id="catmaid" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#catmaid" class="anchor"></a>catmaid</h1></div>
<p>This package provides access to the <a href="http://catmaid.org/">CATMAID</a> API for <a href="http://r-project.org/">R</a> users. At present it provides low level functions for appropriately authenticated GET/POST requests, optionally parsing JSON responses. There are also intermediate level functions that retrieve skeleton (i.e. neuron) information, connectivity information for one or more neurons as well as a number of other API endpoints. Finally, there is a high level function to convert neurons to the representation of the <a href="https://natvese.github.io/nat">nat</a> (NeuroAnatomy Toolbox) R package, enabling a wide variety of analyses.</p>
<p>It is strongly recommended to read through the instructions below, the <a href="http://natverse.github.io/rcatmaid/reference/catmaid-package.html">package overview documentation</a> and then skim the <a href="http://natverse.github.io/rcatmaid/reference/">reference documentation index</a> , which groups the available functions into useful categories.</p>
<div id="quick-start" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-start" class="anchor"></a>Quick start</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install</span>
<span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="st"><a href="https://remotes.r-lib.org">"remotes"</a></span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span>
<span class="co"># nb repo is rcatmaid, but R package name is catmaid</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"natverse/rcatmaid"</span><span class="op">)</span>

<span class="co"># use </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jefferis/rcatmaid">catmaid</a></span><span class="op">)</span>

<span class="co"># general help starting point</span>
<span class="op">?</span><span class="va">catmaid</span></code></pre></div>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>This example is based on EM tracing data from the Drosophila first instar larva by <a href="https://elifesciences.org/articles/14859">Albert Cardona and colleagues</a> as submitted to <a href="https://virtualflybrain.org">Virtual Fly Brain</a> and visible at <a href="https://catmaid.virtualflybrain.org" class="uri">https://catmaid.virtualflybrain.org</a>.</p>
<p>This produces a 3D plot of first and second order olfactory neurons coloured according to the peripheral odorant receptor.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jefferis/rcatmaid">catmaid</a></span><span class="op">)</span>
<span class="co"># Specify VFB CAMAID server containing data</span>
<span class="va">conn</span><span class="op">=</span><span class="fu"><a href="reference/catmaid_login.html">catmaid_login</a></span><span class="op">(</span>server<span class="op">=</span><span class="st">"https://l1em.catmaid.virtualflybrain.org"</span><span class="op">)</span>

<span class="co"># fetch olfactory receptor neurons</span>
<span class="va">orns</span><span class="op">=</span><span class="fu"><a href="reference/read.neuron.catmaid.html">read.neurons.catmaid</a></span><span class="op">(</span><span class="st">"name:ORN (left|right)"</span>, .progress<span class="op">=</span><span class="st">'text'</span><span class="op">)</span>
<span class="co"># calculate some useful metadata</span>
<span class="va">orns</span><span class="op">[</span>,<span class="st">'Or'</span><span class="op">]</span><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">" ORN.*"</span>, <span class="st">""</span>, <span class="va">orns</span><span class="op">[</span>,<span class="st">'name'</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="va">orns</span><span class="op">[</span>,<span class="st">'side'</span><span class="op">]</span><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">".* ORN "</span>, <span class="st">""</span>, <span class="va">orns</span><span class="op">[</span>,<span class="st">'name'</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>

<span class="co"># repeat for their PN partners, note use of search by annotation</span>
<span class="va">pns</span><span class="op">=</span><span class="fu"><a href="reference/read.neuron.catmaid.html">read.neurons.catmaid</a></span><span class="op">(</span><span class="st">"ORN PNs"</span>, .progress<span class="op">=</span><span class="st">'text'</span><span class="op">)</span>
<span class="va">pns</span><span class="op">[</span>,<span class="st">'Or'</span><span class="op">]</span><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">" PN.*"</span>, <span class="st">""</span>, <span class="va">pns</span><span class="op">[</span>,<span class="st">'name'</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="va">pns</span><span class="op">[</span>,<span class="st">'side'</span><span class="op">]</span><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">".*(left|right)"</span>, <span class="st">"\\1"</span>, <span class="va">pns</span><span class="op">[</span>,<span class="st">'name'</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co"># plot, colouring by odorant receptor</span>
<span class="fu"><a href="reference/plot3d.catmaidneuron.html">plot3d</a></span><span class="op">(</span><span class="va">orns</span>, col<span class="op">=</span><span class="va">Or</span><span class="op">)</span>
<span class="co"># note that we plot somata with a radius of 1500 nm</span>
<span class="fu"><a href="reference/plot3d.catmaidneuron.html">plot3d</a></span><span class="op">(</span><span class="va">pns</span>, col<span class="op">=</span><span class="va">Or</span>, soma<span class="op">=</span><span class="fl">1500</span><span class="op">)</span></code></pre></div>
<p>Which produces the following output plot:</p>
<p>[<img src="https://github.com/natverse/rcatmaid/raw/master/docs/articles/example-drosophila-larva-olfactory-system_files/figure-html/plot-1.png" alt="Larval PN">]</p>
</div>
<div id="authentication" class="section level2">
<h2 class="hasAnchor">
<a href="#authentication" class="anchor"></a>Authentication</h2>
<p>You will obviously need to have the login details of a valid CATMAID instance to try this out. As of December 2015 CATMAID is moving to token based authentication. For this you will need to get an API token when you are logged into the CATMAID web client in your browser. See <a href="http://catmaid.github.io/dev/api.html#api-token" class="uri">http://catmaid.github.io/dev/api.html#api-token</a> for details.</p>
<p>Once you have the login information you can use the <code>catmaid_login</code> function to authenticate. The minimal information is your server URL and your CATMAID token.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/catmaid_login.html">catmaid_login</a></span><span class="op">(</span>server<span class="op">=</span><span class="st">"https://mycatmaidserver.org/catmaidroot"</span>,
              authname<span class="op">=</span><span class="st">"Calvin"</span>,authpassword<span class="op">=</span><span class="st">"hobbes"</span>,
              token<span class="op">=</span><span class="st">"9944b09199c62bcf9418ad846dd0e4bbdfc6ee4b"</span><span class="op">)</span></code></pre></div>
<p>Note that the CATMAID servers that I am aware of require two layers of password protection, an outer HTTP auth type user/password combination as well as an inner CATMAID-specific token based login. The outer HTTP auth type user/password combination may be specific to you or generic to the project.</p>
<div id="setting-environment-variables-in-your-renviron-file" class="section level3">
<h3 class="hasAnchor">
<a href="#setting-environment-variables-in-your-renviron-file" class="anchor"></a>Setting environment variables in your .Renviron file</h3>
<p>It is recommended that you set your login details by including code like this in in your <a href="https://www.rdocumentation.org/packages/base/versions/3.4.0/topics/Startup">.Renviron file</a>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">catmaid_server</span><span class="op">=</span><span class="st">"https://mycatmaidserver.org/catmaidroot"</span>
<span class="va">catmaid_token</span><span class="op">=</span><span class="st">"9944b09199c62bcf9418ad846dd0e4bbdfc6ee4b"</span>

<span class="co"># additional security for mycatmaidserver.org/catmaidroot page</span>
<span class="va">catmaid_authname</span><span class="op">=</span><span class="st">"Calvin"</span>
<span class="va">catmaid_authpassword</span><span class="op">=</span><span class="st">"hobbes"</span></code></pre></div>
<p>In this way authentication will happen transparently as required by all functions that interact with the specified CATMAID server.</p>
<p>Be sure to leave <em>one blank line</em> at the end of the .Renviron file, or it will not work. Note that <code>catmaid_server</code> rather than <code>catmaid.server</code> is now the preferred form of specifying environment variables (some shells do not like variables with periods in their name). Note also that the use of package options in your <code>.Rprofile</code> file is still possible but now deprecated.</p>
</div>
<div id="cached-authentication" class="section level3">
<h3 class="hasAnchor">
<a href="#cached-authentication" class="anchor"></a>Cached authentication</h3>
<p>Whether you use options in your <code>.Renviron</code> as described above or you login explicitly at the start of a session using <code>catmaid_login</code> the access credentials will be cached for the rest of the session. You can still authenticate explicitly to a different CATMAID server (using <code>catmaid_login</code>) if you wish.</p>
</div>
<div id="multiple-servers" class="section level3">
<h3 class="hasAnchor">
<a href="#multiple-servers" class="anchor"></a>Multiple servers</h3>
<p>If you use more than one CATMAID server but always do so in different sessions or rmarkdown scripts then you can save an appropriate <code>.Renviron</code> file in the project folder.</p>
<p>If you need to talk to more than one CATMAID server in a single session then you must use <code>catmaid_login</code> to login into each server</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># log in to default server specified in .Renviron/.Rprofile</span>
<span class="va">conn1</span><span class="op">=</span><span class="fu"><a href="reference/catmaid_login.html">catmaid_login</a></span><span class="op">(</span><span class="op">)</span>
<span class="co"># log into another server, presumably with different credentials</span>
<span class="va">conn2</span><span class="op">=</span><span class="fu"><a href="reference/catmaid_login.html">catmaid_login</a></span><span class="op">(</span>server<span class="op">=</span><span class="st">'https://my.otherserver.com'</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
<p>and then use the returned connection objects with any calls you make e.g.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># fetch neuron from server 1</span>
<span class="va">n1</span><span class="op">=</span><span class="fu">read.neuron</span><span class="op">(</span><span class="fl">123</span>, conn<span class="op">=</span><span class="va">conn1</span><span class="op">)</span>
<span class="co"># fetch neuron from server 2</span>
<span class="va">n2</span><span class="op">=</span><span class="fu">read.neuron</span><span class="op">(</span><span class="fl">123</span>, conn<span class="op">=</span><span class="va">conn2</span><span class="op">)</span></code></pre></div>
<p>n.b. you must use connection objects to talk to both servers because if no connection object is specified, the last connection will be re-used.</p>
</div>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>Currently there isn’t a released version on <a href="https://cran.r-project.org/">CRAN</a> but can use the <strong>devtools</strong> package to install the development version:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="st"><a href="https://remotes.r-lib.org">"remotes"</a></span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"natverse/rcatmaid"</span><span class="op">)</span></code></pre></div>
<p>Note: Windows users need <a href="https://cran.r-project.org/bin/windows/Rtools/">Rtools</a> and <a href="https://cran.r-project.org/package=devtools">devtools</a> to install this way.</p>
</div>
<div id="acknowledgements" class="section level2">
<h2 class="hasAnchor">
<a href="#acknowledgements" class="anchor"></a>Acknowledgements</h2>
<p>Originally based on python code presently visible at:</p>
<ul>
<li><a href="https://github.com/catmaid/CATMAID/blob/master/scripts/remote/access.py" class="uri">https://github.com/catmaid/CATMAID/blob/master/scripts/remote/access.py</a></li>
<li><a href="https://github.com/catmaid/CATMAID/blob/master/django/applications/catmaid/urls.py" class="uri">https://github.com/catmaid/CATMAID/blob/master/django/applications/catmaid/urls.py</a></li>
<li><a href="https://github.com/schlegelp/CATMAID-to-Blender/blob/master/CATMAIDImport.py" class="uri">https://github.com/schlegelp/CATMAID-to-Blender/blob/master/CATMAIDImport.py</a></li>
</ul>
<p>by Albert Cardona and Philipp Schlegel. Released under the GPL-3 license.</p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/jefferis/rcatmaid/">https://​github.com/​jefferis/​rcatmaid/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/jefferis/rcatmaid/issues">https://​github.com/​jefferis/​rcatmaid/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Gregory Jefferis <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-0587-9355" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/natverse/rcatmaid"><img src="https://travis-ci.org/natverse/rcatmaid.svg?branch=master" alt="Travis-CI Build Status"></a></li>
<li><a href="https://github.com/natverse/rcatmaid/releases/latest"><img src="https://img.shields.io/github/release/natverse/rcatmaid.svg" alt="Release Version"></a></li>
<li><a href="https://zenodo.org/badge/latestdoi/25650381"><img src="https://zenodo.org/badge/25650381.svg" alt="DOI"></a></li>
<li><a href="https://natverse.github.io"><img src="https://img.shields.io/badge/natverse-Part%20of%20the%20natverse-a241b6" alt="natverse"></a></li>
<li><a href="https://natverse.github.io/rcatmaid/reference/"><img src="https://img.shields.io/badge/docs-100%25-brightgreen.svg" alt="Docs"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Gregory Jefferis.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
